# アンケート設問標準（改訂案）

目的:
- 設問文のゆらぎで列認識が壊れる問題を防ぐ。
- 回答者に自然で分かりやすい日本語を使う。
- 将来は「タグ + 事前マッピング」で列順変更にも耐える。

---

## 1. 基本方針

1. 設問文は「意味が重ならない」ようにする。  
2. 1つの設問で1つの意味だけを聞く（回数/可否/NG日を混在させない）。  
3. 回答者向け文言は自然な日本語にする。  
4. システム認識は「設問文そのもの」ではなく、最終的にタグで固定する。  

---

## 2. 正式な設問文（推奨）

以下を「正」として固定してください。  
（括弧内の `TAG` は運用用。Googleフォーム画面には表示しない）

| TAG | 必須 | 設問文（固定） | 回答形式 |
|---|---|---|---|
| `GRADE` | 必須 | お子さまの現在の学年を選択してください。 | 選択肢 |
| `CLASS` | 必須 | お子さまの現在のクラスを選択してください。 | 選択肢 |
| `NAME` | 必須 | 回答者（保護者）の氏名を入力してください。 | 記述式 |
| `COUNT` | 必須 | 期間中に参加できる合計回数を選択してください。 | 選択肢（1回/2回/何回でも/免除希望） |
| `NG_DATE` | 任意 | 参加できない日（NG日）があれば入力してください。 | 記述式（日付） |
| `PREF_DAY` | 必須 | 参加可能な曜日をすべて選択してください。 | 複数選択（平日） |
| `PREF_MONTH` | 必須 | 参加可能な月をすべて選択してください。 | 複数選択 |
| `PREF_DATE_ONLY` | 任意 | この日なら参加できる日があれば入力してください。 | 記述式（日付） |
| `LOC_1` | 必須 | 希望する旗振り場所を選択してください（第1希望）。 | 選択肢 |
| `LOC_2` | 任意 | 希望する旗振り場所を選択してください（第2希望）。 | 選択肢 |
| `LOC_3` | 任意 | 希望する旗振り場所を選択してください（第3希望）。 | 選択肢 |
| `LOC_4` | 任意 | 希望する旗振り場所を選択してください（第4希望）。 | 選択肢 |
| `ADD_SUPPORT` | 必須 | 欠員時の追加協力は可能ですか。 | はい/いいえ |
| `ADD_COUNT` | 任意 | （「はい」の方）追加で対応可能な回数を入力してください。 | 数値 |
| `FREE_TEXT` | 任意 | 連絡事項があれば入力してください。 | 記述式 |

---

## 3. 注意すべき表現（NG例）

| NG表現 | 問題 | 推奨表現 |
|---|---|---|
| 「この日しか参加できない」 | NG日と混同しやすい | 「この日なら参加できる日」 |
| 「参加可能回数を超えて追加…」 | `COUNT` と `ADD_SUPPORT` が衝突しやすい | 「欠員時の追加協力は可能ですか」 |
| 「第3希望」ラベルの重複（第4希望にも同じ番号） | `LOC_3`/`LOC_4` が誤認識 | 第1〜第4を明確に一意で記載 |
| 「ユーザー名」 | `firstName` と誤認識される | 「メールアドレス」または削除 |

---

## 4. タグ運用案（Googleフォームに表示しない）

結論:
- Googleフォーム単体では「設問に埋め込んだ非表示タグ」は実質不可。
- 代わりに、**事前準備でタグを付与する外部マッピング方式**が有効。

### 4-1. 運用フロー

1. フォーム本体は回答者向けの自然な設問文のみで作成する。  
2. 別ファイル（CSV/スプレッドシート）で `TAG` と「設問文」を管理する。  
3. シフト割り当て前に、回答シートのヘッダーを `TAG` にマッピングして正規化する。  
4. ツール入力には「正規化後シート」を使う。  

### 4-2. マッピング管理の最小構成

`survey_tag_map.csv` 例:

```csv
tag,question_text
GRADE,お子さまの現在の学年を選択してください。
CLASS,お子さまの現在のクラスを選択してください。
NAME,回答者（保護者）の氏名を入力してください。
COUNT,期間中に参加できる合計回数を選択してください。
NG_DATE,参加できない日（NG日）があれば入力してください。
PREF_DAY,参加可能な曜日をすべて選択してください。
PREF_MONTH,参加可能な月をすべて選択してください。
PREF_DATE_ONLY,この日なら参加できる日があれば入力してください。
LOC_1,希望する旗振り場所を選択してください（第1希望）。
LOC_2,希望する旗振り場所を選択してください（第2希望）。
LOC_3,希望する旗振り場所を選択してください（第3希望）。
LOC_4,希望する旗振り場所を選択してください（第4希望）。
ADD_SUPPORT,欠員時の追加協力は可能ですか。
ADD_COUNT,（「はい」の方）追加で対応可能な回数を入力してください。
FREE_TEXT,連絡事項があれば入力してください。
```

### 4-3. 追加ルール

1. 設問文を変更したら、必ずマッピングも同時更新する。  
2. タグ未一致の列が1つでもあれば、割り当て処理を開始しない。  
3. `COUNT` と `ADD_*` は絶対に同じタグにしない。  

---

## 5. 実務上の推奨

1. まずは設問文を本ドキュメントに合わせて統一する。  
2. 次に「タグマッピング前処理」を作る（手作業でも可）。  
3. 最後に `js/script.js` 側を「タグ優先認識」に切り替える。  

