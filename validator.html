<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PTAæ——æŒ¯ã‚Šãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ„ãƒ¼ãƒ«</title>
    <meta name="description" content="PTAã®æ——æŒ¯ã‚Šãƒ»æŒ¨æ‹¶å½“ç•ªã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ãƒ»ä¿®æ­£ç¢ºèªã™ã‚‹ãƒ„ãƒ¼ãƒ«">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸš¸</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        .error-card {
            background-color: #fef2f2;
            border-left: 4px solid var(--color-danger);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
        }

        .warning-card {
            background-color: #fffbeb;
            border-left: 4px solid var(--color-warning);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
        }

        .valid-card {
            background-color: #f0fdf4;
            border-left: 4px solid var(--color-success);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
        }

        .tag-error {
            background-color: var(--color-danger);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .tag-warning {
            background-color: var(--color-warning);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .detail-list {
            list-style: none;
            margin-top: var(--space-sm);
        }

        .detail-user {
            font-weight: bold;
            display: inline-block;
            width: 150px;
        }

        .detail-msg {
            color: var(--color-text-light);
        }
    </style>
</head>

<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <h1 class="logo">ğŸ§¹ ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒ»æ•´å½¢ãƒ„ãƒ¼ãƒ«</h1>
                <p class="tagline">ã‚·ãƒ•ãƒˆä½œæˆå‰ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯</p>
                <div style="margin-top: 10px;">
                    <a href="index.html" style="color: white; text-decoration: underline; font-size: 0.9rem;">ğŸ  ãƒ›ãƒ¼ãƒ </a>
                    <span style="margin: 0 10px; color: rgba(255,255,255,0.5);">|</span>
                    <a href="tool.html" style="color: white; text-decoration: underline; font-size: 0.9rem;">ğŸ¯
                        ã‚·ãƒ•ãƒˆå‰²å½“ã¦</a>
                    <span style="margin: 0 10px; color: rgba(255,255,255,0.5);">|</span>
                    <a href="manual.html" style="color: white; text-decoration: underline; font-size: 0.9rem;">ğŸ“–
                        ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</a>
                    <span style="margin: 0 10px; color: rgba(255,255,255,0.5);">|</span>
                    <a href="survey-sample.html" style="color: white; text-decoration: underline; font-size: 0.9rem;">ğŸ“
                        ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆä¾‹</a>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main container">

            <!-- Step 1: File Upload -->
            <section class="card" id="uploadSection">
                <div class="card-header">
                    <span class="step-badge">STEP 0</span>
                    <h2>Excelç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿</h2>
                </div>
                <div class="card-body">
                    <p style="margin-bottom: 20px;">
                        Googleãƒ•ã‚©ãƒ¼ãƒ ã®å›ç­”ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¾ã›ã¦ã€å…¥åŠ›å†…å®¹ã®ä¸å‚™ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚<br>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€Œæ——æŒ¯ã‚Šã‚·ãƒ•ãƒˆæ—¥ã¨å ´æ‰€ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚èª­ã¿è¾¼ã¾ã›ã‚‹ã¨ã€æ—¥ä»˜ã‚„å ´æ‰€ã®ç…§åˆã‚‚è¡Œãˆã¾ã™ã€‚
                    </p>

                    <div class="upload-grid">
                        <!-- Survey Data (Main Target) -->
                        <div class="upload-box" id="surveyUploadBox">
                            <div class="upload-icon">ğŸ“‹</div>
                            <h3>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆå›ç­”</h3>
                            <p>æ¤œè¨¼ã—ãŸã„ãƒ‡ãƒ¼ã‚¿</p>
                            <input type="file" id="surveyFile" accept=".xlsx,.xls,.csv" hidden>
                            <button class="btn btn-primary" onclick="document.getElementById('surveyFile').click()">
                                ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                            </button>
                            <div class="file-status" id="surveyStatus"></div>
                        </div>

                        <!-- Shift Template (Reference) -->
                        <div class="upload-box" id="shiftUploadBox">
                            <div class="upload-icon">ğŸ“…</div>
                            <h3>æ——æŒ¯ã‚Šã‚·ãƒ•ãƒˆæ—¥ã¨å ´æ‰€</h3>
                            <p>æ—¥ä»˜ã¨å ´æ‰€ã®æ­£èª¤ãƒã‚§ãƒƒã‚¯</p>
                            <input type="file" id="shiftFile" accept=".xlsx,.xls,.csv" hidden>
                            <button class="btn btn-outline" onclick="document.getElementById('shiftFile').click()">
                                ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠï¼ˆä»»æ„ï¼‰
                            </button>
                            <div class="file-status" id="shiftStatus"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Step 2: Validation Results -->
            <section class="card hidden" id="resultSection">
                <div class="card-header">
                    <span class="step-badge">STEP 2</span>
                    <h2>æ¤œè¨¼çµæœãƒ¬ãƒãƒ¼ãƒˆ</h2>
                </div>
                <div class="card-body">
                    <!-- Actions -->
                    <div style="text-align: right; margin-bottom: 20px;">
                        <button class="btn btn-success" id="downloadCleanBtn"
                            style="background-color: var(--color-success); color: white;">
                            âœ¨ æ•´å½¢æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                    </div>

                    <!-- Summary Stats -->
                    <div class="result-summary" id="validationSummary">
                        <!-- Filled by JS -->
                    </div>

                    <!-- Filter Tabs -->
                    <div class="tabs">
                        <button class="tab active" data-filter="all">ã™ã¹ã¦</button>
                        <button class="tab" data-filter="error">âŒ ã‚¨ãƒ©ãƒ¼ (ä¿®æ­£å¿…é ˆ)</button>
                        <button class="tab" data-filter="warning">âš ï¸ è­¦å‘Š (è¦ç¢ºèª)</button>
                    </div>

                    <!-- Issues List -->
                    <div id="issuesList" style="max-height: 600px; overflow-y: auto;">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="footer">
            <div style="margin-bottom: 12px;">
                <a href="contact.html"
                    style="color: rgba(255,255,255,0.9); text-decoration: none; font-weight: 500; font-size: 0.9rem; border-bottom: 1px dashed rgba(255,255,255,0.4);">
                    ğŸ“¨ ãŠå•ã„åˆã‚ã›
                </a>
            </div>
            <p>Â© 2025 åƒè‘‰çœŒæŸå°å­¦æ ¡PTA. All rights reserved.</p>
            <p>PTAæ——æŒ¯ã‚Šã‚·ãƒ•ãƒˆå‰²å½“ã¦ãƒ„ãƒ¼ãƒ« ver.202512</p>
        </footer>
    </div>

    <script src="js/validator.js"></script>
</body>

</html>